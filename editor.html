<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>≈õik·π£ƒÅmitra</title>
    <link rel="icon" type="image/x-icon" href="icon.ico">
    <link href="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.snow.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Gentium+Plus:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body data-theme="light">
    <button class="theme-toggle" id="themeToggle" title="Toggle theme">üåû</button>

    <div class="app-container">
        <div class="ribbon-tabs">
            <div class="tab-headers">
                <div class="app-title-section">
                    <img src="logo.png" alt="≈õik·π£ƒÅmitra logo" class="app-logo">
                    <span class="app-name">≈õik·π£ƒÅmitra</span>
                    <input type="text" id="titleEditHeader" class="title-input-header" value="Untitled document" title="Document title">
                </div>
                <div class="tab-buttons">
                    <button class="tab-header" data-tab="file">File</button>
                    <button class="tab-header active" data-tab="edit">Edit</button>
                    <button class="tab-header" data-tab="insert">Insert</button>
                    <button class="tab-header" data-tab="convert">Convert</button>
                    <button class="tab-header" data-tab="preferences">Preferences</button>
                </div>
            </div>

            <div class="tab-content" id="file-tab">
                <div class="ribbon-groups">
                    <div class="ribbon-group">
                        <div class="group-buttons">
                            <button id="openBtn" class="ribbon-btn" title="Open a saved document">
                                üìÇ Open
                            </button>
                            <button id="saveBtn" class="ribbon-btn" title="Save the document (single self-contained HTML)">
                                üíæ Save
                            </button>
                            <button id="saveAsBtn" class="ribbon-btn" title="Save the document to a new file">
                                üìù Save As‚Ä¶
                            </button>
                        </div>
                        <div class="group-label">Document</div>
                    </div>
                    <div class="ribbon-group">
                        <div class="group-buttons">
                            <button id="exportBtn" class="ribbon-btn" title="Export document (same as Save for now)">
                                üì§ Export‚Ä¶
                            </button>
                        </div>
                        <div class="group-label">Export</div>
                    </div>
                    <div class="ribbon-group">
                        <div class="group-buttons">
                            <label for="titleEdit">Title:</label>
                            <input type="text" id="titleEdit" placeholder="Untitled document" />
                        </div>
                        <div class="group-label">Metadata</div>
                    </div>
                </div>
            </div>

            <div class="tab-content active" id="edit-tab">
                <div class="ribbon-groups">
                    <!-- Font & Size Group -->
                    <div class="ribbon-group">
                        <div class="group-buttons-grid">
                            <select id="fontCombo" title="Font">
                                <option value="">Font (default)</option>
                                <option value="Gentium Plus">Gentium Plus</option>
                                <option value="Arial">Arial</option>
                                <option value="Times New Roman">Times New Roman</option>
                                <option value="Calibri">Calibri</option>
                                <option value="Georgia">Georgia</option>
                                <option value="Verdana">Verdana</option>
                                <option value="Courier New">Courier New</option>
                                <option value="Noto Sans Devanagari">Noto Sans Devanagari</option>
                            </select>
                            <select id="sizeCombo" title="Font Size">
                                <option value="">Size (default)</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                                <option value="14">14</option>
                                <option value="16">16</option>
                                <option value="18">18</option>
                                <option value="20">20</option>
                                <option value="22">22</option>
                                <option value="24">24</option>
                                <option value="28">28</option>
                                <option value="32">32</option>
                                <option value="36">36</option>
                                <option value="48">48</option>
                                <option value="72">72</option>
                            </select>
                        </div>
                        <div class="group-label">Font</div>
                    </div>
                    
                    <!-- Basic Formatting Group -->
                    <div class="ribbon-group">
                        <div class="group-buttons-grid grid-2col">
                            <button id="boldButton" class="ribbon-btn" title="Bold (Ctrl+B)">
                                <strong>B</strong>
                            </button>
                            <button id="italicButton" class="ribbon-btn" title="Italic (Ctrl+I)">
                                <em>I</em>
                            </button>
                            <button id="underlineButton" class="ribbon-btn" title="Underline (Ctrl+U)">
                                <u>U</u>
                            </button>
                            <button id="strikeButton" class="ribbon-btn" title="Strikethrough">
                                <s>S</s>
                            </button>
                        </div>
                        <div class="group-label">Format</div>
                    </div>
                    
                    <!-- Colors Group -->
                    <div class="ribbon-group">
                        <div class="group-buttons-grid grid-2col">
                            <div class="color-picker-wrapper">
                                <label for="textColorPicker" title="Text Color - Click to apply current color">A</label>
                                <input type="color" id="textColorPicker" value="#000000" title="Click to change color">
                            </div>
                            <div class="color-picker-wrapper">
                                <label for="highlightColorPicker" title="Highlight - Click to apply current color" class="highlight-label">H</label>
                                <input type="color" id="highlightColorPicker" value="#ffff00" title="Click to change highlight color">
                            </div>
                            <button id="clearFormatButton" class="ribbon-btn span-2" title="Clear Formatting">
                                üßπ
                            </button>
                        </div>
                        <div class="group-label">Colors</div>
                    </div>
                    
                    <!-- Style & Alignment Group -->
                    <div class="ribbon-group">
                        <div class="group-buttons-grid">
                            <select id="styleCombo">
                                <option value="normal">Normal</option>
                                <option value="change">Change</option>
                                <option value="svara">Svara</option>
                                <option value="short-pause">Short Pause</option>
                                <option value="long-pause">Long Pause</option>
                                <option value="mixed" disabled>Mixed</option>
                            </select>
                            <div class="alignment-buttons">
                                <button id="alignLeftButton" class="ribbon-btn compact" title="Align Left">‚¨Ö</button>
                                <button id="alignCenterButton" class="ribbon-btn compact" title="Align Center">‚¨å</button>
                                <button id="alignRightButton" class="ribbon-btn compact" title="Align Right">‚û°</button>
                            </div>
                        </div>
                        <div class="group-label">Style</div>
                    </div>
                    
                    <!-- Holdings & Pauses Group -->
                    <div class="ribbon-group">
                        <div class="group-buttons-grid grid-3col">
                            <button id="shortHoldingButton" class="ribbon-btn" title="Apply or remove short holding (thin green rectangle) on selection">
                                <span class="holding-icon short">a</span>
                            </button>
                            <button id="shortPauseButton" class="ribbon-btn" title="Insert short pause (blue vertical line)">
                                <span class="pause-icon short">|</span>
                            </button>
                            <button id="viramaButton" class="ribbon-btn" title="Insert avagraha (apostrophe for missing letter)">
                                '
                            </button>
                            <button id="longHoldingButton" class="ribbon-btn" title="Apply or remove long holding (thick green rectangle) on selection">
                                <span class="holding-icon long">a</span>
                            </button>
                            <button id="longPauseButton" class="ribbon-btn" title="Insert long pause (red vertical line)">
                                <span class="pause-icon long">|</span>
                            </button>
                            <button id="cleanHoldingsButton" class="ribbon-btn" title="Remove holdings from the current selection only">
                                ‚ùå
                            </button>
                        </div>
                        <div class="group-label">Holdings</div>
                    </div>
                    
                    <!-- Svara Accents Group -->
                    <div class="ribbon-group">
                        <div class="group-buttons-grid grid-2col">
                            <button id="svaritaButton" class="ribbon-btn small" title="Svarita - apply to previous character">aÃç</button>
                            <button id="anudattaButton" class="ribbon-btn small" title="Anudatta - apply to previous character">aÃ±</button>
                            <button id="udattaButton" class="ribbon-btn small" title="Udatta - apply to previous character">aÃé</button>
                            <button id="tickButton" class="ribbon-btn small" title="Tick mark - apply to previous character">aÀé</button>
                        </div>
                        <div class="group-label">Svara</div>
                    </div>
                    
                    <!-- Automatic Processing Group -->
                    <div class="ribbon-group automatic-group">
                        <div class="group-buttons">
                            <button id="applyHoldingsButton" class="ribbon-btn auto-btn" title="Automatically apply holdings according to Sanskrit grammatical rules">
                                <span class="auto-icon">ab<span class="hold-demo">c</span></span>
                            </button>
                            <button id="applyPausesButton" class="ribbon-btn auto-btn" title="Automatically apply pauses according to Sanskrit grammatical rules">
                                <span class="auto-icon">a<span class="pause-demo">|</span>bc</span>
                            </button>
                        </div>
                        <div class="group-label">Automatic</div>
                    </div>
                </div>
            </div>

            <!-- Insert Tab Content -->
            <div class="tab-content" id="insert-tab">
                <div class="ribbon-groups">
                    <div class="ribbon-group">
                        <div class="group-buttons">
                            <div class="iast-dropdown-container">
                                <button class="ribbon-btn" id="iastMenuBtn" title="Insert IAST Characters (F9 + key for shortcuts)">
                                    <span style="font-family: 'Gentium Plus', serif; font-size: 16px;">Insert IAST</span>
                                </button>
                                <div class="iast-dropdown-menu" id="iastMenu">
                                    <div class="iast-menu-content">
                                        <table class="iast-table">
                                            <caption>Vowels & Special</caption>
                                            <tbody>
                                                <tr>
                                                    <td><button class="iast-char-btn" data-char="ƒÅ" title="F9+a">ƒÅ</button></td>
                                                    <td><button class="iast-char-btn" data-char="ƒ´" title="F9+i">ƒ´</button></td>
                                                    <td><button class="iast-char-btn" data-char="≈´" title="F9+u">≈´</button></td>
                                                    <td><button class="iast-char-btn" data-char="·πõ" title="F9+r">·πõ</button></td>
                                                    <td><button class="iast-char-btn" data-char="·πù" title="F9+R">·πù</button></td>
                                                </tr>
                                                <tr>
                                                    <td><button class="iast-char-btn" data-char="·∏∑" title="F9+l">·∏∑</button></td>
                                                    <td><button class="iast-char-btn" data-char="·∏π" title="F9+L">·∏π</button></td>
                                                    <td><button class="iast-char-btn" data-char="·πÅ" title="F9+m">·πÅ</button></td>
                                                    <td><button class="iast-char-btn" data-char="·∏•" title="F9+h">·∏•</button></td>
                                                    <td></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        
                                        <table class="iast-table">
                                            <caption>Gutturals</caption>
                                            <tbody>
                                                <tr>
                                                    <td><button class="iast-char-btn" data-char="k">k</button></td>
                                                    <td><button class="iast-char-btn" data-char="kh">kh</button></td>
                                                    <td><button class="iast-char-btn" data-char="g">g</button></td>
                                                    <td><button class="iast-char-btn" data-char="gh">gh</button></td>
                                                    <td><button class="iast-char-btn" data-char="·πÖ" title="F9+G">·πÖ</button></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        
                                        <table class="iast-table">
                                            <caption>Palatals</caption>
                                            <tbody>
                                                <tr>
                                                    <td><button class="iast-char-btn" data-char="c">c</button></td>
                                                    <td><button class="iast-char-btn" data-char="ch">ch</button></td>
                                                    <td><button class="iast-char-btn" data-char="j">j</button></td>
                                                    <td><button class="iast-char-btn" data-char="jh">jh</button></td>
                                                    <td><button class="iast-char-btn" data-char="√±" title="F9+J">√±</button></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        
                                        <table class="iast-table">
                                            <caption>Retroflexes</caption>
                                            <tbody>
                                                <tr>
                                                    <td><button class="iast-char-btn" data-char="·π≠" title="F9+t">·π≠</button></td>
                                                    <td><button class="iast-char-btn" data-char="·π≠h" title="F9+T">·π≠h</button></td>
                                                    <td><button class="iast-char-btn" data-char="·∏ç" title="F9+d">·∏ç</button></td>
                                                    <td><button class="iast-char-btn" data-char="·∏çh" title="F9+D">·∏çh</button></td>
                                                    <td><button class="iast-char-btn" data-char="·πá" title="F9+n">·πá</button></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        
                                        <table class="iast-table">
                                            <caption>Dentals</caption>
                                            <tbody>
                                                <tr>
                                                    <td><button class="iast-char-btn" data-char="t">t</button></td>
                                                    <td><button class="iast-char-btn" data-char="th">th</button></td>
                                                    <td><button class="iast-char-btn" data-char="d">d</button></td>
                                                    <td><button class="iast-char-btn" data-char="dh">dh</button></td>
                                                    <td><button class="iast-char-btn" data-char="n">n</button></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        
                                        <table class="iast-table">
                                            <caption>Labials</caption>
                                            <tbody>
                                                <tr>
                                                    <td><button class="iast-char-btn" data-char="p">p</button></td>
                                                    <td><button class="iast-char-btn" data-char="ph">ph</button></td>
                                                    <td><button class="iast-char-btn" data-char="b">b</button></td>
                                                    <td><button class="iast-char-btn" data-char="bh">bh</button></td>
                                                    <td><button class="iast-char-btn" data-char="m">m</button></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        
                                        <table class="iast-table">
                                            <caption>Semivowels & Sibilants</caption>
                                            <tbody>
                                                <tr>
                                                    <td><button class="iast-char-btn" data-char="y">y</button></td>
                                                    <td><button class="iast-char-btn" data-char="r">r</button></td>
                                                    <td><button class="iast-char-btn" data-char="l">l</button></td>
                                                    <td><button class="iast-char-btn" data-char="v">v</button></td>
                                                    <td><button class="iast-char-btn" data-char="≈õ" title="F9+s">≈õ</button></td>
                                                </tr>
                                                <tr>
                                                    <td><button class="iast-char-btn" data-char="·π£" title="F9+S">·π£</button></td>
                                                    <td><button class="iast-char-btn" data-char="s">s</button></td>
                                                    <td><button class="iast-char-btn" data-char="h">h</button></td>
                                                    <td></td>
                                                    <td></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="group-label">Characters</div>
                    </div>
                </div>
            </div>

            <!-- Convert Tab Content -->
            <div class="tab-content" id="convert-tab">
                <div class="ribbon-groups">
                    <div class="ribbon-group">
                        <div class="group-buttons">
                            <button id="devanagariToIastBtn" class="ribbon-btn" title="Convert selected Devanagari text to IAST">
                                ‡§¶‡•á‡§µ ‚Üí IAST
                            </button>
                            <button id="iastToDevanagariBtn" class="ribbon-btn" title="Convert selected IAST text to Devanagari">
                                IAST ‚Üí ‡§¶‡•á‡§µ
                            </button>
                        </div>
                        <div class="group-label">Transliteration</div>
                    </div>
                    <div class="ribbon-group">
                        <div class="group-buttons">
                            <!-- Empty for now -->
                        </div>
                        <div class="group-label">Marking consistency</div>
                    </div>
                </div>
            </div>

            <!-- Preferences Tab Content -->
            <div class="tab-content" id="preferences-tab">
                <div class="ribbon-groups">
                    <div class="ribbon-group">
                        <div class="group-buttons">
                            <label for="cleanupModeCombo">Cleanup strategy:</label>
                            <select id="cleanupModeCombo" title="Controls how holdings cleanup runs after edits.">
                                <option value="complete">Complete and reliable (default)</option>
                                <option value="balanced">Balanced (localized + debounce)</option>
                                <option value="localized">Localized only (fast)</option>
                                <option value="save-only">On Save only</option>
                            </select>
                        </div>
                        <div class="group-label">Editing behavior</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Document Container (like main2.pyw paper background) -->
        <div class="container">
            <div id="editor" spellcheck="false"></div>
        </div>
        
        <!-- Console (bottom-left, above status bar) -->
        <div class="console-container" id="consoleContainer">
            <div class="console-header" id="consoleHeader">
                <span class="console-title">Console</span>
                <div class="console-controls">
                    <button class="console-btn" id="consoleClear" title="Clear console">üóëÔ∏è</button>
                    <button class="console-btn" id="consoleToggle" title="Minimize/Maximize">‚àí</button>
                </div>
            </div>
            <div class="console-content" id="consoleContent"></div>
        </div>
        
        <!-- Status Bar -->
        <div class="statusbar">
            <div class="statusbar-left">
                <span id="wordCount">Words: 0</span>
                <span class="separator">|</span>
                <span id="charCount">Characters: 0</span>
                <span class="separator">|</span>
                <span id="lineCount">Lines: 1</span>
            </div>
            <div class="statusbar-right">
                <span>Zoom:</span>
                <input type="range" id="zoomSlider" min="50" max="200" value="100" step="10" title="Adjust zoom level">
                <span id="zoomLevel">100%</span>
            </div>
        </div>
    </div>

    <!-- Hidden file input -->
    <input type="file" id="fileInput" accept=".txt,.html,.md" style="display: none;">

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.js"></script>
    <script src="sanskrit_rules.js"></script>
    <script src="theme-manager.js"></script>
    <script src="file-operations.js"></script>
    <script src="editor-quill.js"></script>
</body>
</html>

